<!DOCTYPE html><html lang="en-US" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="pv-cache-enabled" content="false"><meta name="generator" content="Jekyll v4.2.0" /><meta property="og:title" content="HackIN CTF" /><meta name="author" content="Noah Tongate" /><meta property="og:locale" content="en_US" /><meta name="description" content="Intro Recently, I competed in a CTF hosted by Booz Allen Hamilton and sponsored by NAVSEA and IN3 to name a few. I found out about the CTF through a social media post and a flyer that was sent throughout the University of Louisville Computer Science Department. I registered and told some of my friends although many of the students at UofL have any interest in CTFs or Security I managed to get a few students to join. Since the event was completely virtual, we were sent a Slack invite to a group chat with all the other members. Although some students from my school decided to join, I decided to meet some new people and find a group. The group I joined was comprised of students, each from a different school. A couple of the members of the group were electrical engineering majors and the other member was a computer science major. The group I joined have either never played in a CTF or have once before so I knew it would be interesting to see how we work together and share ideas to solve the problems. I will be going over the problems I solved but will vaguely discuss the problems my teammates solved." /><meta property="og:description" content="Intro Recently, I competed in a CTF hosted by Booz Allen Hamilton and sponsored by NAVSEA and IN3 to name a few. I found out about the CTF through a social media post and a flyer that was sent throughout the University of Louisville Computer Science Department. I registered and told some of my friends although many of the students at UofL have any interest in CTFs or Security I managed to get a few students to join. Since the event was completely virtual, we were sent a Slack invite to a group chat with all the other members. Although some students from my school decided to join, I decided to meet some new people and find a group. The group I joined was comprised of students, each from a different school. A couple of the members of the group were electrical engineering majors and the other member was a computer science major. The group I joined have either never played in a CTF or have once before so I knew it would be interesting to see how we work together and share ideas to solve the problems. I will be going over the problems I solved but will vaguely discuss the problems my teammates solved." /><link rel="canonical" href="https://ap3x.github.io/posts/hackin-ctf/" /><meta property="og:url" content="https://ap3x.github.io/posts/hackin-ctf/" /><meta property="og:site_name" content="Ap3x Security" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-10-09T13:07:22-04:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="HackIN CTF" /><meta name="google-site-verification" content="hc0WsMROlLqBrjOZFEzVWbNtkroIFS0ATmWAsvSWHP8" /> <script type="application/ld+json"> {"headline":"HackIN CTF","dateModified":"2020-10-09T13:07:22-04:00","datePublished":"2020-10-09T13:07:22-04:00","description":"Intro Recently, I competed in a CTF hosted by Booz Allen Hamilton and sponsored by NAVSEA and IN3 to name a few. I found out about the CTF through a social media post and a flyer that was sent throughout the University of Louisville Computer Science Department. I registered and told some of my friends although many of the students at UofL have any interest in CTFs or Security I managed to get a few students to join. Since the event was completely virtual, we were sent a Slack invite to a group chat with all the other members. Although some students from my school decided to join, I decided to meet some new people and find a group. The group I joined was comprised of students, each from a different school. A couple of the members of the group were electrical engineering majors and the other member was a computer science major. The group I joined have either never played in a CTF or have once before so I knew it would be interesting to see how we work together and share ideas to solve the problems. I will be going over the problems I solved but will vaguely discuss the problems my teammates solved.","url":"https://ap3x.github.io/posts/hackin-ctf/","mainEntityOfPage":{"@type":"WebPage","@id":"https://ap3x.github.io/posts/hackin-ctf/"},"@type":"BlogPosting","author":{"@type":"Person","name":"Noah Tongate"},"@context":"https://schema.org"}</script><title>HackIN CTF | Ap3x Security</title><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-LSK4HZJM17"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-LSK4HZJM17'); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/profile/avatar.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Ap3x Security</a></div><div class="site-subtitle font-italic">Security Engineer, OSCP Certified, Wannabe Hacker, and Engineering Student</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/Ap3x" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['noah.tongate','gmail.com'].join('@')" aria-label="email" class="order-4" > <i class="fas fa-envelope"></i> </a> <a href="https://www.linkedin.com/in/noahtongate" aria-label="linkedin" class="order-5" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a> <a href="/feed.xml" aria-label="rss" class="order-6" > <i class="fas fa-rss"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>HackIN CTF</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>HackIN CTF</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Fri, Oct 9, 2020, 1:07 PM -0400" > Oct 9, 2020 <i class="unloaded">2020-10-09T13:07:22-04:00</i> </span> by <span class="author"> Noah Tongate </span></div><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2814 words">15 min</span></div></div><div class="post-content"><h1 id="intro">Intro</h1><p>Recently, I competed in a CTF hosted by Booz Allen Hamilton and sponsored by NAVSEA and IN3 to name a few. I found out about the CTF through a social media post and a flyer that was sent throughout the University of Louisville Computer Science Department. I registered and told some of my friends although many of the students at UofL have any interest in CTFs or Security I managed to get a few students to join. Since the event was completely virtual, we were sent a Slack invite to a group chat with all the other members. Although some students from my school decided to join, I decided to meet some new people and find a group. The group I joined was comprised of students, each from a different school. A couple of the members of the group were electrical engineering majors and the other member was a computer science major. The group I joined have either never played in a CTF or have once before so I knew it would be interesting to see how we work together and share ideas to solve the problems. I will be going over the problems I solved but will vaguely discuss the problems my teammates solved.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/post/2020-10-09-hackin-ctf/HackIN-11.jpeg" style="width: 75%" /></p><h1 id="a-week-out">A Week Out</h1><p>About a week out I received the hardware needed for the competition and in the package was a micro-USB cable, USB stick, and a custom PBC board with keyboard keys and an Arduino Pro Micro attached to the board. On the USB stick was a password protected zip folder that contained a virtual box VM. I knew from previous projects that boards like the Arduino Leonardo and Pro Micro can emulate HID’s (Human-Interface Devices) such as a keyboard or mouse. But the keys on the board were not marked so it made me curious. What was running on the board? What key commands does it send? So, I began to test this using the <code class="language-plaintext highlighter-rouge">showkey</code> command in Linux which allows to you to see the values sent by the keys. There are other tools on Linux that can do something similar like <code class="language-plaintext highlighter-rouge">xbindkeys</code>, etc, but for now showkeys worked. I mapped out the keys and took note of it as shown below:</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/post/2020-10-09-hackin-ctf/HackIN-Keys.png" style="width: 75%" /></p><p>I noticed there was a key that did not send anything, so I was curious if it was used as a key-combo. I held the key down and began to click through each of the key and to my surprise I was right. There was a key-combo that allowed the user to send <code class="language-plaintext highlighter-rouge">up,down, left, right, "a", and "b"</code></p><h1 id="the-competition-begins">The Competition Begins!</h1><p>Our group already had a plan and had our VMs up and running. We immediately split up into solving challenges that best suit our skill set. There was a category called “Hardware” that my teammates solved. In order to retreive all the flags for that category, you’re required to dump the firmware of the device. We used <code class="language-plaintext highlighter-rouge">avrdude</code> then you had to open the file in Ghidra to do some more analysis. The challenges in this category also asked about general info about the device such as the number of general-purpose registers, number of digital pins, dump EEPROM, ect. We used the instruction manual to solve many of the flags too. Many of these could have been solved prior to this, but we had no idea going in that we would have to dump the firmware.</p><p>I logged into the CentOS VM and did some light recon of enumerating through the directories for any odd files or process info on the VM. I did not find anything that stood out, so I ventured to plug in the keypad given to us. This time, after doing some more recon, I noticed that there were some new files in the <code class="language-plaintext highlighter-rouge">/tmp</code> folder. One was a <code class="language-plaintext highlighter-rouge">. pid</code> file so I knew that the keypad was linked to some kind of process.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/post/2020-10-09-hackin-ctf/HackIN-1.png" style="width: 75%" /></p><p>When I ran <code class="language-plaintext highlighter-rouge">ps aux</code> there did not seem to be anything currently running. So, to combat this I unplugged my keypad and noticed that it shut down my VM. I brushed it off and moved and started everything back up I ran <code class="language-plaintext highlighter-rouge">watch ps aux</code> to watch for any processes that start up when the device is plugged in and sure enough there was.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/post/2020-10-09-hackin-ctf/HackIN-2.png" style="width: 75%" /></p><h1 id="digging-deeper-into-the-kernel">Digging Deeper into the Kernel</h1><p>One of the challenges stated:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>Identify the kernel module handling the keypad in the .ova image.
</pre></table></code></div></div><p>Now that we know what is running, we can begin to piece things together. So, I started to look for the suspicious kernel modules and out of luck; I tried grepping for “HackIN” since that’s the name of the CTF and to my surprise, I found something of interest.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/post/2020-10-09-hackin-ctf/HackIN-3.png" style="width: 75%" /></p><p>We can view the file location and info about it using <code class="language-plaintext highlighter-rouge">modinfo HackIN_HID</code>. The next few challenges directed me to reverse engineer the module and figure out if it does anything else. I was having some issues with VirtualBox drag’n’drop feature since my daily driver is Kubuntu I could simply send over the file using netcat. I setup a listener on my host and sent the file from the VM to my host IP and port.</p><p>Now that the file is on our system, we can now open this in Ghidra to reverse engineer it. After importing it into Ghidra and analyzing it, I began first by searching for any strings. Sure enough, there were some interesting strings which led me to find more flags.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/post/2020-10-09-hackin-ctf/HackIN-4.png" style="width: 75%" /></p><p>A lot of the strings stuck out, but the most interesting ones were the top two strings: <code class="language-plaintext highlighter-rouge">/bin/explorer.exe</code> and <code class="language-plaintext highlighter-rouge">netfilter_lkm</code>.</p><p>We recognized the explorer.exe file from one of the processes that were running on the system so this may be helpful later. When you double-click on it, then right-click on the memory address you can search for references to that string. This brought me to this function called <code class="language-plaintext highlighter-rouge">hid_hackin_probe</code></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/post/2020-10-09-hackin-ctf/HackIN-5.png" style="width: 75%" /></p><p>We can clearly see that this kernel module calls for a helper called <code class="language-plaintext highlighter-rouge">/bin/explorer.exe</code>, but it also requests another module called <code class="language-plaintext highlighter-rouge">netfilter_lkm</code>. So then what does <code class="language-plaintext highlighter-rouge">netfilter_lkm</code> do?</p><p>Once I sent the kernel module over to my host system and loaded that into Ghidra, I started looking at the strings for anything interesting again. We hit gold again! This time, an IP address: <code class="language-plaintext highlighter-rouge">175.129.12.94</code> which I presume is being connected to.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/post/2020-10-09-hackin-ctf/HackIN-6.png" style="width: 75%" /></p><p>Now, let us view where this string is referenced: On the left-hand side of Ghidra, in the Symbol Tree panel, we can search for any functions that we would like to look at. One of the things that struck my attention was the <code class="language-plaintext highlighter-rouge">kernel_power_off</code> and <code class="language-plaintext highlighter-rouge">nf_register_net_hook</code>. These are Linux kernel functions and are used in our malicious kernel module. The function <code class="language-plaintext highlighter-rouge">nf_register_net_hook</code> is used in the netfilter.h library. We used Bootlin to help us understand the kernel functions being called. MORE INFO <a href="https://elixir.bootlin.com/linux/v4.10/source/include/linux/netfilter.h#L156">HERE</a> and <a href="https://elixir.bootlin.com/linux/latest/source/kernel/reboot.c#L287">HERE</a></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/post/2020-10-09-hackin-ctf/HackIN-7.png" style="width: 75%" /></p><p>When we look at where these functions are called, we can see they are called in the initialization of our kernel module. Without going into detail, we can see that when some condition is not met then it sends a power off. This must be why our VM shuts down when we unplug the keypad.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/post/2020-10-09-hackin-ctf/HackIN-8.png" style="width: 75%" /></p><p>After digging into the linux kernel a bit more, we can see that <code class="language-plaintext highlighter-rouge">nf_register_net_hook</code> accepts two parameters passed into it which are structs.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/post/2020-10-09-hackin-ctf/HackIN-9.png" style="width: 75%" /></p><p>Looking back at our decompiled code, we can see the variables that are passed. The variable <code class="language-plaintext highlighter-rouge">puVar3</code> is assigned some address. If we double-click on that it will lead us to some jumbled data that we can assume is our <code class="language-plaintext highlighter-rouge">nf_hook_ops</code> struct data. We can right-click on the address and disassemble it and now we can see where our IP address we found in the strings is being used.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/post/2020-10-09-hackin-ctf/HackIN-10.png" style="width: 100%" /></p><p>I was also curious to see if the IP address resolves to anything in our <code class="language-plaintext highlighter-rouge">/etc/resolv.conf</code> file and it does. It resolves to <code class="language-plaintext highlighter-rouge">evil.ru.site</code></p><p>We can come back to this module little later, but for now let us</p><p>find other artifacts that may be left behind</p><h1 id="udev-rules">UDEV Rules!</h1><p>Now that we know what the basic idea what the kernel module is doing we can now piece that together with what is actual process is running on the system by reviewing the files we found on start up.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/post/2020-10-09-hackin-ctf/HackIN-2.png" style="width: 75%" /></p><p>We can start by looking at <code class="language-plaintext highlighter-rouge">/bin/connected.sh</code></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/post/2020-10-09-hackin-ctf/HackIN-13.png" style="width: 100%" /></p><p>We can see that the connected script logs when the device was connected into <code class="language-plaintext highlighter-rouge">/tmp/maypad_scripts.log</code>. The command after that essentially passes <code class="language-plaintext highlighter-rouge">event6</code> to <code class="language-plaintext highlighter-rouge">/bin/exfilpad</code>. I’m a bit familiar with the Linux filesystem so I instantly recognized this as a device file possibly in <code class="language-plaintext highlighter-rouge">/dev/input/</code>. Without digging into <code class="language-plaintext highlighter-rouge">/bin/exfilpad</code> we can assume that the exfilpad reads the input from the <code class="language-plaintext highlighter-rouge">/dev/input/event6</code> device file of the keypad and interprets it.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/post/2020-10-09-hackin-ctf/HackIN-14.png" style="width: 100%" /> <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/post/2020-10-09-hackin-ctf/HackIN-15.png" style="width: 100%" /></p><p>We never found where <code class="language-plaintext highlighter-rouge">/bin/connected.sh</code> is triggered to execute since it is not called by the kernel module. I decided to check <code class="language-plaintext highlighter-rouge">/etc/udev/rules.d/</code>. This is where you can setup rules to process a device. In the file there were two rules for the keypad. When the device was plugged in it ran <code class="language-plaintext highlighter-rouge">connected.sh</code> and when it was unplugged it executes <code class="language-plaintext highlighter-rouge">disconnected.sh</code>.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/post/2020-10-09-hackin-ctf/HackIN-12.png" style="width: 100%" /></p><h1 id="whats-the-secret-code">Whats the Secret Code?</h1><p>Okay, now we know what the kernel modules are doing on the system, but what exactly does the binaries like <code class="language-plaintext highlighter-rouge">explorer.exe</code> and <code class="language-plaintext highlighter-rouge">exfilpad</code> do? One of the challenges says:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>Code? Secret Activation Keys? Backdoor?
Figure out the correct sequence of keys to execute the program's hidden modes.
Submit the sequence as the answer.
</pre></table></code></div></div><p>We can assume that the keypad has some special key combo that is used to unlock something. We can start by looking at <code class="language-plaintext highlighter-rouge">exfilpad</code> since we already know that the input device file id is passed to it. Looking at the main, we can see some interesting functions. The one we are going to focus on is <code class="language-plaintext highlighter-rouge">read_maypad()</code>, but before we go any further, we need to see what is being passed to that function. It looks like the <code class="language-plaintext highlighter-rouge">local_118</code> an empty char array of size 268 is passed to <code class="language-plaintext highlighter-rouge">fgets</code> which reads the standard input from the terminal and saves it into <code class="language-plaintext highlighter-rouge">local_118</code>. Which we presume <code class="language-plaintext highlighter-rouge">event6</code> is passed to the standard input via <code class="language-plaintext highlighter-rouge">connected.sh</code></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/post/2020-10-09-hackin-ctf/HackIN-16.png" style="width: 60%" /></p><p>Let me break down what exactly happens here:</p><p>First, I am going rename the variables with bad name conventions, but it should be easy to follow along. We can see that <code class="language-plaintext highlighter-rouge">event6</code> is passed into <code class="language-plaintext highlighter-rouge">read_maypad</code>. Then on lines 24 and 25 if converted to ascii then it is the directory of event6 which is <code class="language-plaintext highlighter-rouge">/dev/input/</code>. All this is then concatenated into the variable we named called <code class="language-plaintext highlighter-rouge">dir_event6_p1</code> then the file descriptor is returned showing that we can properly open the file.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/post/2020-10-09-hackin-ctf/HackIN-17.png" style="width: 60%" /></p><p>The next part of the function is where it gets interesting. For some reason, Ghidra cannot properly analyze the array, but from lines 35 to 44 we can assume that is all one array. If someone knows a better way to fix this in Ghidra, let me know (I’ll explain why we can assume this later). So the while loop starting at line 46 checks to see if the file descriptor is valid and reads the input from the <code class="language-plaintext highlighter-rouge">/dev/input/event6</code> and compares it to the array of hex which we can actually convert to decimal since we learned earlier from the <code class="language-plaintext highlighter-rouge">showkey</code> command in Linux it returns the decimal of the key or you could use this <a href="http://cherrytree.at/misc/vk.htm">site</a>. Then on line 55, we can see that it checks to see if the user inputs the correct 10 keys and sets the variable <code class="language-plaintext highlighter-rouge">index_arr</code> to 0, which will be used later.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/post/2020-10-09-hackin-ctf/HackIN-18.png" style="width: 60%" /></p><p>For the sake of time I used this <a href="http://cherrytree.at/misc/vk.htm">site</a> to find out the decimal values that map to keys.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre>Hex Array of Key combo:
 67  67  6c  6c  69  6a  69  6a 30 1e

Converted to Decimal:
103 103 108 108 105 106 105 106 48 30

Corresponding Keys:
UP, UP, DOWN, DOWN, LEFT, RIGHT, LEFT, RIGHT, b, a
</pre></table></code></div></div><p>The next challenge is to find the kill switch key combo that stops everything. If we scroll down a little more, we can see a similar instance of reading the keys and comparing them to something. We do not have to look any further than line 71 to see that the string, <code class="language-plaintext highlighter-rouge">aaa</code>, is the kill switch. Just to ensure I was not missing anything along the way, I searched for strings and found an easy flag in plaintext.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/post/2020-10-09-hackin-ctf/HackIN-19.png" style="width: 75%" /></p><p>Another piece of code that caught my attention was on line 72 in a function called <code class="language-plaintext highlighter-rouge">connect_site</code>. When you double-click on it and view the decompiled code, you can see right away that on line 17 our keystrokes are being sent to <code class="language-plaintext highlighter-rouge">"evil.ru.site:8080/dump/time=%d&amp;keystroke=%s"</code></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/post/2020-10-09-hackin-ctf/HackIN-20.png" style="width: 75%" /></p><p>What now? Well now we test to see what happens if we manually execute <code class="language-plaintext highlighter-rouge">explorer.exe</code>. It seems to start a server on port 8080 so when you navigate to <code class="language-plaintext highlighter-rouge">evil.ru.site:8080</code> in the browser you can see this:</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/post/2020-10-09-hackin-ctf/HackIN-21.png" style="width: 75%" /></p><p>BUT WHAT DOES IT MEAN? … I was not sure honestly… But what happens if we navigate to <code class="language-plaintext highlighter-rouge">/dump</code> directory that we found in the <code class="language-plaintext highlighter-rouge">connect_site</code> function? We get this:</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/post/2020-10-09-hackin-ctf/HackIN-22.png" style="width: 75%" /></p><p>After doing some searching, we found a logs folder in the same place as explorer.exe which contained files that with the same name as what was displayed in the browser. We played around with the server and the exfilpad binary some more, then noticed that pressing the keys generates the files. When you open one of the files in the logs folder it looks empty, but it’s not.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>DISCLAIMER: At this point, our team stopped so we were unable to figure out what exactly was happening in the log files.
After the competition, I was told that when viewed in VIM there are a bunch of ASCII periods separated by one whitespace.
If you compare two of the log files you can see that the top and bottom are the same in all log files and the only thing that changes is the middle.
Somehow, you can able to use a Vigenere cipher and other methods to figure out the key.
</pre></table></code></div></div><p>Although we couldn’t figure out the logs file, we managed to get two more flags before the competition ended. The next challenge said:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>"HTTP Dir Busting" : We need to determine some of the functionality of the server.
A co-worker started writing an application to test server endpoints/directories, but quickly
noticed some server "funny business" and went home early. Please finish writing the script
and report back with a list of valid server endpoints (URLs).
Please see the included python file and wordlist in the challenges folder.
</pre></table></code></div></div><p>I used <a href="https://github.com/maurosoria/dirsearch">dirsearch</a> to exclude the unnecessary responses that returned “Don’t Exploit me, bro” and obtain a list of valid endpoints.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/post/2020-10-09-hackin-ctf/HackIN-24.png" style="width: 75%" /></p><p>VALID ENDPOINTS:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre><td class="rouge-code"><pre>evil.ru.site:8080/
evil.ru.site:8080/about
evil.ru.site:8080/admin/login
evil.ru.site:8080/cgi-bin/index.pl
evil.ru.site:8080/dump
evil.ru.site:8080/dump.inc
evil.ru.site:8080/dump.inc.old
evil.ru.site:8080/dump.log
evil.ru.site:8080/dump.old
evil.ru.site:8080/dump.rar
evil.ru.site:8080/dump.rdb
evil.ru.site:8080/dump.sql
evil.ru.site:8080/dump.sql.old evil.ru.site:8080/dump.sqlite
evil.ru.site:8080/dump.tar
evil.ru.site:8080/dump.tar.bz2 evil.ru.site:8080/dump.tar.gz
evil.ru.site:8080/dump.tgz
evil.ru.site:8080/dump.zip
evil.ru.site:8080/dumpenv
evil.ru.site:8080/dumper
evil.ru.site:8080/dumps
evil.ru.site:8080/dumpuser
evil.ru.site:8080/dumpuser.aspx
evil.ru.site:8080/dump.7z
evil.ru.site:8080/list
evil.ru.site:8080/phpMyAdmin-3.3.4/
evil.ru.site:8080/kill
</pre></table></code></div></div><p>We also noticed that there was some “bad programming” going on in the server request and response. There was a <code class="language-plaintext highlighter-rouge">isAdmin:</code> parameter in the response that was empty. So, if we added this to the header of our request we could see if we would get a response. We were able to modify the header and get the flag.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/post/2020-10-09-hackin-ctf/HackIN-23.png" style="width: 75%" /></p><h1 id="winners">Winners!!!!</h1><p>The CTF closed and our team placed 3rd for a $1000 cash prize that will be split between each team member.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/post/2020-10-09-hackin-ctf/HackIN-25.jpeg" style="width: 75%" /></p><h1 id="conclusion">Conclusion</h1><p>Although our team met the day before the competition, we worked really well together . It was interesting to learn about each team member’s background, especially about their majors. Overall, this is one of the most interesting and fun CTF I have done in a while. I was able to meet some great people with diverse backgrounds and we happened to come in 3rd to win a cash prize. Although the money is nice it was great to learn, meet new people, and just have fun doing what we are passionate about. I look forward to next year’s competition.</p><h1 id="extra">Extra</h1><p>There were some interesting challenges that hardly any other team managed to solve and that was the two “RISC-V” challenges. One of our team members managed to solve it though. We were given a binary that was developed using RISC-V. The binary requested a password and we had to figure out what exactly was the password was to get the flag. There were multiple arrays that contained pieces of a password is would compare each char from the user input to the corresponding array with the password pieces.</p><p>For those in the competition and still have the binary file the password was: <code class="language-plaintext highlighter-rouge">Lucky7h1r733n</code></p><p>There were a couple more challenges that appeared after we solved the RISC-V challenges, but we didn’t have enough time to view it.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/ctf/'>CTF</a>, <a href='/categories/hardware-ctf/'>Hardware CTF</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/ctf/" class="post-tag no-text-decoration" >ctf</a> <a href="/tags/hardware/" class="post-tag no-text-decoration" >hardware</a> <a href="/tags/kernel/" class="post-tag no-text-decoration" >kernel</a> <a href="/tags/linux/" class="post-tag no-text-decoration" >linux</a> <a href="/tags/malware/" class="post-tag no-text-decoration" >malware</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=HackIN CTF - Ap3x Security&url=https://ap3x.github.io/posts/hackin-ctf/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=HackIN CTF - Ap3x Security&u=https://ap3x.github.io/posts/hackin-ctf/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=HackIN CTF - Ap3x Security&url=https://ap3x.github.io/posts/hackin-ctf/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/exploit-education-protostar-stack-series/">Exploit Exercise Protostar Stack Series</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/exploit/">exploit</a> <a class="post-tag" href="/tags/osce/">osce</a> <a class="post-tag" href="/tags/development/">development</a> <a class="post-tag" href="/tags/homelab/">homelab</a> <a class="post-tag" href="/tags/how-to/">how to</a> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/networking/">networking</a> <a class="post-tag" href="/tags/overflow/">overflow</a> <a class="post-tag" href="/tags/pentesting/">pentesting</a> <a class="post-tag" href="/tags/proxmox/">proxmox</a></div></div></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/infection-monkey-securing-my-network/"><div class="card-body"> <span class="timeago small" > Aug 10, 2020 <i class="unloaded">2020-08-10T11:48:01-04:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Infection Monkey - Securing My Network</h3><div class="text-muted small"><p> DEFCON Safe Mode 2020 - Infection Monkey During this week of DEFCON Safe Mode I listened to a lot of fantastic talks from new techniques about Domain Hiding (Domain Fronting), Red Team CCDC techniq...</p></div></div></a></div><div class="card"> <a href="/posts/exploit-education-protostar-stack-series/"><div class="card-body"> <span class="timeago small" > Dec 14, 2020 <i class="unloaded">2020-12-14T10:49:32-05:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Exploit Exercise Protostar Stack Series</h3><div class="text-muted small"><p> Exploit Exercises Protostar Stack Series In this series I will solve each of the seven levels of in from exploit exercises protostar. You can find more info about the challenges here. I will show ...</p></div></div></a></div><div class="card"> <a href="/posts/pivoting-with-chisel/"><div class="card-body"> <span class="timeago small" > Nov 18, 2020 <i class="unloaded">2020-11-18T11:17:34-05:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Pivoting with Chisel</h3><div class="text-muted small"><p> Summary Recently I’ve completed the Hack The Box Dante Pro Labs and really enjoyed it. One of the most crucial pieces to being successful in the lab is understanding how to pivot properly. So I wan...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/proxmox-vm-creation-script-for-quick-pentest-lab/" class="btn btn-outline-primary" prompt="Older"><p>Proxmox VM Creation Script for Quick Pentest Lab</p></a> <a href="/posts/htb-dante-pro-lab-and-thm-throwback-network-lab/" class="btn btn-outline-primary" prompt="Newer"><p>HTB Dante Pro Lab and THM Throwback AD Lab</p></a></div><div id="disqus" class="pt-2 pb-2"><p class="text-center text-muted small pb-5"> Loading comments from <a href="https://disqus.com/">Disqus</a> ...</p></div><script src="/assets/js/lib/jquery.disqusloader.min.js"></script> <script> const options = { scriptUrl: '//blog-9jgepddjsv.disqus.com/embed.js', disqusConfig: function() { this.page.title = 'HackIN CTF'; this.page.url = 'https://ap3x.github.io/posts/hackin-ctf/'; this.page.identifier = '/posts/hackin-ctf/'; } }; $.disqusLoader('#disqus', options); </script></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('.post-content img'); const observer = lozad(imgs); observer.observe(); </script><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2021 <a href="https://github.com/Ap3x">Noah Tongate</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/exploit/">exploit</a> <a class="post-tag" href="/tags/osce/">osce</a> <a class="post-tag" href="/tags/development/">development</a> <a class="post-tag" href="/tags/homelab/">homelab</a> <a class="post-tag" href="/tags/how-to/">how to</a> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/networking/">networking</a> <a class="post-tag" href="/tags/overflow/">overflow</a> <a class="post-tag" href="/tags/pentesting/">pentesting</a> <a class="post-tag" href="/tags/proxmox/">proxmox</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://ap3x.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
